<% title( @user.name, @pool.full_title ) %>

<h1><%= link_to @pool.full_title, pool_path(@pool)  %> › <%= @user.name %></h1>

<table>
 <tr>
   <td>1. Platz</td>
   <td>
       <!-- fix: use helper or partial -->
     <% if @play.team1.present? %>
         <%= image_tag( @play.team1.img ) if @play.team1.img.present? %>
         <%= @play.team1.title %>
       <% else %>
          ---
       <% end %>
   </td>
 </tr>
 <tr>
   <td>2. Platz</td>
   <td>
       <% if @play.team2.present? %>
         <%= image_tag( @play.team2.img ) if @play.team2.img.present? %>
         <%= @play.team2.title %>
       <% else %>
          ---
       <% end %>
   </td>
 </tr>
 <% if @pool.team3? %>
 <tr>
   <td>3. Platz</td>
   <td><% if @play.team3.present? %>
         <%= image_tag( @play.team3.img ) if @play.team3.img.present? %>
         <%= @play.team3.title %>
       <% else %>
          ---
       <% end %>
   </td>
 </tr>
<% end %>
</table>


<!-- table columns:
        1    => toto12x
        2    => bingo
        2    => team1
        3    => tip 
        4    => result
        5    => team2
        6    => date
  -->

<table class='play'>
  
<% @rounds.each do |round| %>
<tr class='game-round'>
  <td colspan='3'></td>
  <td colspan='4' class='game-round-title'><%= round.title %></td>
</tr>

  <% if @pool.flex? && round.calc? %>
     <tr>
       <td colspan='2'></td>
       <td colspan='4' class='game-no-fixtures'>Spielaufstellungen noch nicht bekannt.</td>
     </tr>
  <% else %>
  <% round.games.each do |game| %>
  <% tip = Tip.find_by_user_and_pool_and_game( @user, @pool, game ) %>
    <tr>
      <td class='game-toto12x'>
       <% if tip.present? && tip.score1.present? && tip.score2.present? %>
          (<%= tip.toto12x %>)
       <% end %>
      </td>

      <td class='game-bingo'>
       <% if tip.present? %>
          <% if tip.complete? %>
             <span class='smaller <%= tip.bingo_style_class %>'><%= tip.bingo_text %></span>
          <% else %>
             <span class='smaller missing'>?</span>
          <% end %>
       <% end %>
      </td>
      
       <td class='game-team1'>
         <span class='<%= game.team1_style_class %>'>
             <%= game.team1.title %>
         </span>
         <%= image_tag( game.team1.img ) if game.team1.img.present? %>
       </td>
       
       <% if tip.present? %>
        <td class='game-tip'>
          <span class='<%= tip.bingo_style_class %>'>
            <%= tip.score1_str %> : <%= tip.score2_str %>
          </span>
         </td>
       <% else %>
          <td class='game-tip'>♦<!-- fehler: datensatz fehlt! --></td>
       <% end %>

         <td class='game-score'>
         ( <%= game.score1_str %> : <%= game.score2_str %> )
         </td>
       
        <td class='game-team2'>
          <%= image_tag( game.team2.img ) if game.team2.img.present? %>
          <span class='<%= game.team2_style_class %>'>
             <%= game.team2.title %>
         </span>
        </td>

         <td class='game-date'>
            <%= fmt_date( game.play_at ) %>
         </td>
     </tr>     
  <% end %> <!-- games -->
  <% end %> <!-- if pool.flex? && round.calc? -->
<% end %> <!-- rounds -->

</table>

<%= link_to '« Zurück', pool_path( @pool ), :class => 'btn' %>